{"ast":null,"code":"var _jsxFileName = \"/home/nguyendung/Desktop/PTUDW/caro/src/components/Game.js\";\nimport React from 'react';\nimport '../index.css';\nimport Board from './Board';\nconst nSquareToWin = 5; // tim vi tri dau tien trong chuoi 5 ky tu win\n\nfunction calculateWinner(squares, m, n) {\n  if (m === -1 && n === -1) return null;\n  let win;\n  let tmpRowTop = m;\n  let tmpRowBot = m;\n  let tmpColTop = n;\n  let tmpColBot = n; // xet cac vi tri xung quanh diem danh\n\n  var temp = 1;\n\n  while (tmpRowTop > 0 && temp !== 5) {\n    tmpRowTop -= 1;\n    temp += 1;\n  }\n\n  temp = 1;\n\n  while (tmpColTop > 0 && temp !== 5) {\n    tmpColTop -= 1;\n    temp += 1;\n  }\n\n  temp = 1;\n\n  while (tmpRowBot < 19 && temp !== 5) {\n    tmpRowBot += 1;\n    temp += 1;\n  }\n\n  temp = 1;\n\n  while (tmpColBot < 19 && temp !== 5) {\n    tmpColBot += 1;\n    temp += 1;\n  }\n\n  for (let i = tmpRowTop; i <= tmpRowBot; i++) {\n    for (let j = tmpColTop; j <= tmpColBot; j++) {\n      //Kiểm trang NSquareToWin ô liên tiếp từ ô xuất phát sang phải, xuống góc phải dưới, xuống góc trái dưới\n      //Nếu có NSquareToWin - 1 cặp liên tiếp giống nhau thì thắng\n      //Direction: ToRight, ToRightDown, ToDown, ToLeftDown\n      if (!squares[i][j]) continue; //TH1: chan 2 dau ngang \n\n      win = true; // TH vuot qua ban co va bi chan 2 dau\n\n      if (j - 1 >= 0 && j + nSquareToWin < 20 && squares[i][j - 1] && squares[i][j + 5] && squares[i][j] !== squares[i][j - 1] && squares[i][j] !== squares[i][j + 5]) win = false;\n\n      for (let k = 0; k < nSquareToWin - 1 && win; k++) {\n        if (j + k === 19 || squares[i][j + k] !== squares[i][j + k + 1]) {\n          win = false;\n          break;\n        }\n      }\n\n      if (win) return {\n        val: squares[i][j],\n        x: j,\n        y: i,\n        direction: 'ToRight'\n      }; //TH1: chan 2 dau doc\n\n      win = true;\n      if (i - 1 >= 0 && i + nSquareToWin < 20 && squares[i - 1][j] && squares[i + 5][j] && squares[i][j] !== squares[i - 1][j] && squares[i][j] !== squares[i + 5][j]) win = false;\n\n      for (let k = 0; k < nSquareToWin - 1 && win; k++) {\n        if (i + k === 19 || squares[i + k][j] !== squares[i + k + 1][j]) {\n          win = false;\n          break;\n        }\n      }\n\n      if (win) return {\n        val: squares[i][j],\n        x: j,\n        y: i,\n        direction: 'ToDown'\n      }; //TH1: chan 2 dau cheo phai\n\n      win = true;\n      if (j - 1 >= 0 && j + nSquareToWin < 20 && i - 1 >= 0 && i + nSquareToWin < 20 && squares[i - 1][j - 1] && squares[i + 5][j + 5] && squares[i][j] !== squares[i - 1][j - 1] && squares[i][j] !== squares[i + 5][j + 5]) win = false;\n\n      for (let k = 0; k < nSquareToWin - 1 && win; k++) {\n        if (i + k === 19 || j + k === 19 || squares[i + k][j + k] !== squares[i + k + 1][j + k + 1]) {\n          win = false;\n          break;\n        }\n      }\n\n      if (win) return {\n        val: squares[i][j],\n        x: j,\n        y: i,\n        direction: 'ToRightDown'\n      }; //TH1: chan 2 dau cheo trai \n\n      win = true;\n      if (i - 1 >= 0 && i + nSquareToWin < 20 && j - nSquareToWin >= 0 && squares[i - 1][j + 1] && squares[i + 5][j - 5] && squares[i][j] !== squares[i - 1][j + 1] && squares[i][j] !== squares[i + 5][j - 5]) win = false;\n\n      for (let k = 0; k < nSquareToWin - 1 && win; k++) {\n        if (i + k === 19 || j - k === 0 || squares[i + k][j - k] !== squares[i + k + 1][j - k - 1]) {\n          win = false;\n          break;\n        }\n      }\n\n      if (win) return {\n        val: squares[i][j],\n        x: j,\n        y: i,\n        direction: 'ToLeftDown'\n      };\n    }\n  }\n\n  return null;\n} //Quan ly game\n\n\nclass Game extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleReverse = () => {\n      this.setState({\n        isReverse: !this.state.isReverse\n      });\n    };\n\n    this.jumpTo = move => {\n      this.setState({\n        stepNumber: move,\n        isNext: move % 2 === 0\n      });\n    };\n\n    this.handleClick = (i, j) => {\n      // Chúng ta cần clone history ra bản phụ tránh làm ảnh hưởng bản chính\n      const history = this.state.history.slice(0, this.state.stepNumber + 1); // Lấy history của lần gần nhất\n\n      const current = history[history.length - 1];\n      let squares = current.squares.slice(); //clone moi dong\n\n      current.squares.map((row, idx) => {\n        squares[idx] = current.squares[idx].slice();\n        return true;\n      });\n\n      if (current.isWin || squares[i][j]) {\n        return; //neu da co gia tri thi ko thay doi\n      }\n\n      squares[i][j] = this.state.isNext ? 'X' : 'O';\n      var tmp = false;\n\n      if (calculateWinner(squares, i, j)) {\n        tmp = true;\n      }\n\n      this.setState({\n        history: history.concat([{\n          squares: squares,\n          location: i + ',' + j,\n          isWin: tmp\n        }]),\n        isNext: !this.state.isNext,\n        stepNumber: history.length,\n        idX: i,\n        idY: j\n      });\n    };\n\n    this.handleReset = () => {\n      this.setState({\n        history: [{\n          squares: Array(20).fill(null).map(() => Array(20).fill(null)),\n          location: '',\n          isWin: false\n        }],\n        isNext: true,\n        stepNumber: 0,\n        idX: -1,\n        idY: -1\n      });\n    };\n\n    this.state = {\n      history: [{\n        squares: Array(20).fill(null).map(() => Array(20).fill(null)),\n        location: '',\n        isWin: null\n      }],\n      isNext: true,\n      stepNumber: 0,\n      isReverse: false,\n      idX: -1,\n      idY: -1\n    }; // khoi tao state la matrix voi kich thuoc 20*20\n  }\n\n  render() {\n    //chi dung de view nen ko can clone ra ban nhap\n    const history = this.state.history;\n    const current = history[this.state.stepNumber];\n    const squares = current.squares;\n    const winner = calculateWinner(squares, this.state.idX, this.state.idY);\n    let status;\n\n    if (winner) {\n      status = \"Winner is: \" + winner.val; // Nếu winner có giá trị thì sẽ hiển thị người thắng cuộc\n    } else if (this.state.stepNumber === 20 * 20) {\n      // Nếu sau 9 lần chưa có ai win thì hòa\n      status = \"No one win\";\n    } else {\n      status = \"Next player is: \" + (this.state.isNext ? 'X' : 'O');\n    }\n\n    const moves = history.map((step, move) => {\n      if (move !== 0) {\n        const descr = \"Move \".concat(move, \": (\").concat(step.location, \")\");\n        return this.state.stepNumber === move ? React.createElement(\"li\", {\n          key: move,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          onClick: () => this.jumpTo(move),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198\n          },\n          __self: this\n        }, React.createElement(\"b\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198\n          },\n          __self: this\n        }, descr))) : React.createElement(\"li\", {\n          key: move,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          onClick: () => this.jumpTo(move),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202\n          },\n          __self: this\n        }, descr));\n      }\n\n      return null;\n    });\n    let arrow = this.state.isReverse ? '↓' : '↑';\n    return React.createElement(\"div\", {\n      className: \"game\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"game-board\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, React.createElement(Board, {\n      winner: winner,\n      squares: squares,\n      onClick: (i, j) => this.handleClick(i, j),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"game-info\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, \"INFORMATION\")), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, status), React.createElement(\"button\", {\n      className: \"btn\",\n      onClick: () => this.handleReverse(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, \"Sort \", arrow), React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, this.state.isReverse ? moves.reverse() : moves), React.createElement(\"button\", {\n      className: \"btn\",\n      onClick: () => this.handleReset(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, \"Reset\"))) //gui du lieu squares cho Board\n    ;\n  }\n\n}\n\nexport default Game;","map":{"version":3,"sources":["/home/nguyendung/Desktop/PTUDW/caro/src/components/Game.js"],"names":["React","Board","nSquareToWin","calculateWinner","squares","m","n","win","tmpRowTop","tmpRowBot","tmpColTop","tmpColBot","temp","i","j","k","val","x","y","direction","Game","Component","constructor","props","handleReverse","setState","isReverse","state","jumpTo","move","stepNumber","isNext","handleClick","history","slice","current","length","map","row","idx","isWin","tmp","concat","location","idX","idY","handleReset","Array","fill","render","winner","status","moves","step","descr","arrow","reverse"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport '../index.css';\r\nimport Board from './Board';\r\n\r\nconst nSquareToWin = 5;\r\n\r\n// tim vi tri dau tien trong chuoi 5 ky tu win\r\nfunction calculateWinner(squares, m, n) {\r\n    if (m === -1 && n === -1) return null;\r\n    let win;\r\n    let tmpRowTop = m;\r\n    let tmpRowBot = m;\r\n    let tmpColTop = n;\r\n    let tmpColBot = n;\r\n    // xet cac vi tri xung quanh diem danh\r\n    var temp = 1;\r\n    while (tmpRowTop > 0 && temp !== 5) {\r\n        tmpRowTop -= 1;\r\n        temp += 1;\r\n    }\r\n\r\n    temp = 1;\r\n    while (tmpColTop > 0 && temp !== 5) {\r\n        tmpColTop -= 1;\r\n        temp += 1;\r\n    }\r\n\r\n    temp = 1;\r\n    while (tmpRowBot < 19 && temp !== 5) {\r\n        tmpRowBot += 1;\r\n        temp += 1;\r\n    }\r\n\r\n    temp = 1;\r\n    while (tmpColBot < 19 && temp !== 5) {\r\n        tmpColBot += 1;\r\n        temp += 1;\r\n    }\r\n\r\n    for (let i = tmpRowTop; i <= tmpRowBot; i++) {\r\n        for (let j = tmpColTop; j <= tmpColBot; j++) {\r\n            //Kiểm trang NSquareToWin ô liên tiếp từ ô xuất phát sang phải, xuống góc phải dưới, xuống góc trái dưới\r\n            //Nếu có NSquareToWin - 1 cặp liên tiếp giống nhau thì thắng\r\n            //Direction: ToRight, ToRightDown, ToDown, ToLeftDown\r\n            if (!squares[i][j]) continue;\r\n\r\n            //TH1: chan 2 dau ngang \r\n            win = true;\r\n            // TH vuot qua ban co va bi chan 2 dau\r\n            if (j - 1 >= 0 && j + nSquareToWin < 20 && squares[i][j - 1] && squares[i][j + 5] && squares[i][j] !== squares[i][j - 1] && squares[i][j] !== squares[i][j + 5]) win = false;\r\n            for (let k = 0; k < nSquareToWin - 1 && win; k++) {\r\n                if (j + k === 19 ||squares[i][j + k] !== squares[i][j + k + 1]) {\r\n                    win = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (win) return { val: squares[i][j], x: j, y: i, direction: 'ToRight' };\r\n\r\n            //TH1: chan 2 dau doc\r\n            win = true;\r\n            if (i - 1 >= 0 && i + nSquareToWin < 20 && squares[i - 1][j] && squares[i + 5][j] && squares[i][j] !== squares[i - 1][j] && squares[i][j] !== squares[i + 5][j]) win = false;\r\n            for (let k = 0; k < nSquareToWin - 1 && win; k++) {\r\n                if (i + k === 19 || squares[i + k][j] !== squares[i + k + 1][j]) {\r\n                    win = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (win) return { val: squares[i][j], x: j, y: i, direction: 'ToDown' };\r\n\r\n            //TH1: chan 2 dau cheo phai\r\n            win = true;\r\n            if (j - 1 >= 0 && j + nSquareToWin < 20 && i - 1 >= 0 && i + nSquareToWin < 20 && squares[i - 1][j - 1] && squares[i + 5][j + 5] && squares[i][j] !== squares[i - 1][j - 1] && squares[i][j] !== squares[i + 5][j + 5]) win = false;\r\n            for (let k = 0; k < nSquareToWin - 1 && win; k++) {\r\n                if (i + k === 19 || j + k === 19 || squares[i + k][j + k] !== squares[i + k + 1][j + k + 1]) {\r\n                    win = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (win) return { val: squares[i][j], x: j, y: i, direction: 'ToRightDown' };\r\n\r\n            //TH1: chan 2 dau cheo trai \r\n            win = true;\r\n            if (i - 1 >= 0 && i + nSquareToWin < 20 && j - nSquareToWin >= 0 && squares[i - 1][j + 1] && squares[i + 5][j - 5] && squares[i][j] !== squares[i - 1][j + 1] && squares[i][j] !== squares[i + 5][j - 5]) win = false;\r\n            for (let k = 0; k < nSquareToWin - 1 && win; k++) {\r\n                if (i + k === 19 || j - k === 0 || squares[i + k][j - k] !== squares[i + k + 1][j - k - 1]) {\r\n                    win = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (win) return { val: squares[i][j], x: j, y: i, direction: 'ToLeftDown' };\r\n\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\n//Quan ly game\r\nclass Game extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            history: [{\r\n                squares: Array(20).fill(null).map(() => Array(20).fill(null)),\r\n                location: '',\r\n                isWin: null,\r\n            }],\r\n            isNext: true,\r\n            stepNumber: 0,\r\n            isReverse: false,\r\n            idX: -1,\r\n            idY: -1,\r\n        }; // khoi tao state la matrix voi kich thuoc 20*20\r\n    }\r\n\r\n    handleReverse = () => {\r\n        this.setState({\r\n            isReverse: !this.state.isReverse\r\n        });\r\n    }\r\n\r\n    jumpTo = (move) => {\r\n        this.setState({\r\n            stepNumber: move,\r\n            isNext: (move % 2) === 0,\r\n        })\r\n    }\r\n\r\n    handleClick = (i, j) => {\r\n        // Chúng ta cần clone history ra bản phụ tránh làm ảnh hưởng bản chính\r\n        const history = this.state.history.slice(0, this.state.stepNumber + 1); \r\n        // Lấy history của lần gần nhất\r\n        const current = history[history.length - 1]; \r\n        let squares = current.squares.slice();\r\n\r\n        //clone moi dong\r\n        current.squares.map((row, idx) => {\r\n            squares[idx] = current.squares[idx].slice();\r\n            return true;\r\n        })\r\n\r\n        if (current.isWin || squares[i][j]) {\r\n            return; //neu da co gia tri thi ko thay doi\r\n        }\r\n        squares[i][j] = this.state.isNext ? 'X' : 'O';\r\n        var tmp = false;\r\n        if (calculateWinner(squares, i, j)) {\r\n            tmp = true;\r\n        }\r\n\r\n        this.setState({\r\n            history: history.concat([{\r\n                squares: squares,\r\n                location: i + ',' + j,\r\n                isWin: tmp\r\n            }]),\r\n            isNext: !this.state.isNext,\r\n            stepNumber: history.length,\r\n            idX: i,\r\n            idY: j\r\n        });\r\n    }\r\n\r\n    handleReset = () => {\r\n        this.setState({\r\n            history: [{\r\n                squares: Array(20).fill(null).map(() => Array(20).fill(null)),\r\n                location: '',\r\n                isWin: false,\r\n            }],\r\n            isNext: true,\r\n            stepNumber: 0,\r\n            idX: -1,\r\n            idY: -1,\r\n        });\r\n    }\r\n\r\n    render() {\r\n        //chi dung de view nen ko can clone ra ban nhap\r\n        const history = this.state.history;\r\n        const current = history[this.state.stepNumber];\r\n        const squares = current.squares;\r\n        const winner = calculateWinner(squares, this.state.idX, this.state.idY);\r\n        let status;\r\n\r\n        if (winner) {\r\n            status = \"Winner is: \" + winner.val; // Nếu winner có giá trị thì sẽ hiển thị người thắng cuộc\r\n        } else if (this.state.stepNumber === 20 * 20) { // Nếu sau 9 lần chưa có ai win thì hòa\r\n            status = \"No one win\";\r\n        } else {\r\n            status = \"Next player is: \" + (this.state.isNext ? 'X' : 'O');\r\n        }\r\n\r\n        const moves = history.map((step, move)=>{\r\n            if(move !== 0){\r\n                const descr = `Move ${move}: (${step.location})`;\r\n                return (this.state.stepNumber === move) ? (\r\n                    <li key={move}>\r\n                      <button onClick={() => this.jumpTo(move)}><b>{descr}</b></button>\r\n                    </li>\r\n                  ) : (\r\n                    <li key={move}>\r\n                    <button onClick={() => this.jumpTo(move)}>{descr}</button>\r\n                  </li>\r\n                  );\r\n            }\r\n            return null;\r\n        });\r\n\r\n        let arrow = this.state.isReverse ? '↓' : '↑';\r\n\r\n        return (\r\n            <div className=\"game\">\r\n                <div className=\"game-board\">\r\n                    <Board winner={winner} squares={squares} onClick={(i, j) => this.handleClick(i, j)} />\r\n                </div>\r\n                <div className=\"game-info\">\r\n                    <div><b>INFORMATION</b></div>\r\n                    <p>{status}</p>\r\n                    <button className=\"btn\" onClick={() => this.handleReverse()}>Sort {arrow}</button>\r\n                    <ul>{this.state.isReverse ? moves.reverse() : moves}</ul>\r\n                    <button className=\"btn\" onClick={() => this.handleReset()}>\r\n                        Reset\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            //gui du lieu squares cho Board\r\n        );\r\n    }\r\n}\r\n\r\n\r\n\r\nexport default Game;\r\n\r\n"]},"metadata":{},"sourceType":"module"}